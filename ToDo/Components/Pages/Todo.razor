@using ToDo.Models;
@page "/todo"
@rendermode InteractiveServer

<h3>Todo</h3>

<EditForm Model="@newTodo" OnValidSubmit="HandleValidSubmit" FormName="AddTodo">


    <div class="form-group">
        <label for="todo">What you need to do?</label>
        <InputText id="todotext" class="form-control" @bind-Value="newTodo.TodoText"  required />
    </div>
    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <button type="submit" class="btn btn-primary mt-3">Add</button>
    </div>
</EditForm>

@foreach(var todolist in TodoList)
    {
<div class="row mt-3 shadow-sm " >
    <div class="col-auto d-flex justify-content-center">@todolist.TodoText</div>
    <div class="col d-flex justify-content-end"><button class="btn btn-primary" @onclick="() => DeleteItem(todolist)">Delete</button></div>
  
</div>
}


@code {
    private List<TodoModel> TodoList = new List<TodoModel> { };
    private TodoModel newTodo = new TodoModel();
    int nextId = 1;


    public async Task HandleValidSubmit()
    {
        newTodo.Id = nextId;
        nextId++;
        TodoList.Add(newTodo);
        newTodo = new TodoModel();
    }

    private async Task DeleteItem(TodoModel todoItem)
    {
        nextId--;
        TodoList.Remove(todoItem);
        
    }


}
